<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>8. 面向对象编程</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.021324d1.css" as="style"><link rel="preload" href="/assets/js/app.10b0d601.js" as="script"><link rel="preload" href="/assets/js/2.2959cc1c.js" as="script"><link rel="preload" href="/assets/js/17.579cf571.js" as="script"><link rel="prefetch" href="/assets/js/10.9cbbc5c7.js"><link rel="prefetch" href="/assets/js/11.698025f3.js"><link rel="prefetch" href="/assets/js/12.f5b7035e.js"><link rel="prefetch" href="/assets/js/13.9d4fea56.js"><link rel="prefetch" href="/assets/js/14.20b73f37.js"><link rel="prefetch" href="/assets/js/15.f45ceac0.js"><link rel="prefetch" href="/assets/js/16.dbad7df2.js"><link rel="prefetch" href="/assets/js/18.41fd52b4.js"><link rel="prefetch" href="/assets/js/3.fcf23d77.js"><link rel="prefetch" href="/assets/js/4.fb4f81e2.js"><link rel="prefetch" href="/assets/js/5.05ba125a.js"><link rel="prefetch" href="/assets/js/6.015f8eaa.js"><link rel="prefetch" href="/assets/js/7.023872ca.js"><link rel="prefetch" href="/assets/js/8.dfec0f28.js"><link rel="prefetch" href="/assets/js/9.ca0a9da6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.021324d1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_8-面向对象编程"><a href="#_8-面向对象编程" class="header-anchor">#</a> 8. 面向对象编程</h1> <h2 id="_8-1-概述"><a href="#_8-1-概述" class="header-anchor">#</a> 8.1 概述</h2> <p>对于面向对象编程的支持 Go 语言设计得非常简洁而优雅。因为， Go 语言并没有沿袭传统面向对象编程中的诸多概念，比如继承(不支持继承，尽管匿名字段的内存布局和行为类似继承，但它并不是继承)、虚函数、构造函数和析构函数、隐藏的 this 指针等。</p> <p>尽管 Go 语言中没有封装、继承、多态这些概念，但同样通过别的方式实现这些特性：
 封装：通过方法实现
 继承：通过匿名字段实现
 多态：通过接口实现</p> <h2 id="_8-2-匿名组合"><a href="#_8-2-匿名组合" class="header-anchor">#</a> 8.2 匿名组合</h2> <h3 id="_8-2-1-匿名字段"><a href="#_8-2-1-匿名字段" class="header-anchor">#</a> 8.2.1 匿名字段</h3> <p>一般情况下，定义结构体的时候是字段名与其类型一一对应，实际上 Go 支持只提供类型，而不写字段名的方式，也就是匿名字段，也称为嵌入字段。</p> <p>当匿名字段也是一个结构体的时候，那么这个结构体所拥有的全部字段都被隐式地引入了当前定义的这个结构体。
//人</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token comment">//学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，那么默认Student就包含了Person的所有字段</span>
    id     <span class="token builtin">int</span>
    addr   <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-2-2-初始化"><a href="#_8-2-2-初始化" class="header-anchor">#</a> 8.2.2 初始化</h3> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token comment">//人</span>
<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，那么默认Student就包含了Person的所有字段</span>
    id     <span class="token builtin">int</span>
    addr   <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//顺序初始化</span>
    s1 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;sz&quot;</span><span class="token punctuation">}</span>
    <span class="token comment">//s1 = {Person:{name:mike sex:109 age:18} id:1 addr:sz}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;s1 = %+v\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>

    <span class="token comment">//s2 := Student{&quot;mike&quot;, 'm', 18, 1, &quot;sz&quot;} //err</span>

    <span class="token comment">//部分成员初始化1</span>
    s3 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">:</span> Person<span class="token punctuation">{</span><span class="token string">&quot;lily&quot;</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">}</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
    <span class="token comment">//s3 = {Person:{name:lily sex:102 age:19} id:2 addr:}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;s3 = %+v\n&quot;</span><span class="token punctuation">,</span> s3<span class="token punctuation">)</span>

    <span class="token comment">//部分成员初始化2</span>
    s4 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">:</span> Person<span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&quot;tom&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
    <span class="token comment">//s4 = {Person:{name:tom sex:0 age:0} id:3 addr:}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;s4 = %+v\n&quot;</span><span class="token punctuation">,</span> s4<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-2-3-成员的操作"><a href="#_8-2-3-成员的操作" class="header-anchor">#</a> 8.2.3 成员的操作</h3> <div class="language-Go extra-class"><pre class="language-go"><code>    <span class="token keyword">var</span> s1 Student <span class="token comment">//变量声明</span>
    <span class="token comment">//给成员赋值</span>
    s1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;mike&quot;</span> <span class="token comment">//等价于 s1.Person.name = &quot;mike&quot;</span>
    s1<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'m'</span>
    s1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span>
    s1<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
    s1<span class="token punctuation">.</span>addr <span class="token operator">=</span> <span class="token string">&quot;sz&quot;</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">//{{mike 109 18} 1 sz}</span>

    <span class="token keyword">var</span> s2 Student <span class="token comment">//变量声明</span>
    s2<span class="token punctuation">.</span>Person <span class="token operator">=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;lily&quot;</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">}</span>
    s2<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
    s2<span class="token punctuation">.</span>addr <span class="token operator">=</span> <span class="token string">&quot;bj&quot;</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span> <span class="token comment">//{{lily 102 19} 2 bj}</span>
</code></pre></div><h3 id="_8-2-4-同名字段"><a href="#_8-2-4-同名字段" class="header-anchor">#</a> 8.2.4 同名字段</h3> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token comment">//人</span>
<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，那么默认Student就包含了Person的所有字段</span>
    id     <span class="token builtin">int</span>
    addr   <span class="token builtin">string</span>
    name   <span class="token builtin">string</span> <span class="token comment">//和Person中的name同名</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s Student <span class="token comment">//变量声明</span>

    <span class="token comment">//给Student的name，还是给Person赋值？</span>
    s<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;mike&quot;</span>

    <span class="token comment">//{Person:{name: sex:0 age:0} id:0 addr: name:mike}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>

    <span class="token comment">//默认只会给最外层的成员赋值</span>
    <span class="token comment">//给匿名同名成员赋值，需要显示调用</span>
    s<span class="token punctuation">.</span>Person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    <span class="token comment">//Person:{name:yoyo sex:0 age:0} id:0 addr: name:mike}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-2-5-其它匿名字段"><a href="#_8-2-5-其它匿名字段" class="header-anchor">#</a> 8.2.5 其它匿名字段</h3> <h4 id="_8-2-5-1-非结构体类型"><a href="#_8-2-5-1-非结构体类型" class="header-anchor">#</a> 8.2.5.1 非结构体类型</h4> <p>所有的内置类型和自定义类型都是可以作为匿名字段的：</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> mystr <span class="token builtin">string</span> <span class="token comment">//自定义类型</span>

<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，结构体类型</span>
    <span class="token builtin">int</span>     <span class="token comment">// 匿名字段，内置类型</span>
    mystr   <span class="token comment">// 匿名字段，自定义类型</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//初始化</span>
    s1 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;bj&quot;</span><span class="token punctuation">}</span>

    <span class="token comment">//{Person:{name:mike sex:109 age:18} int:1 mystr:bj}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>

    <span class="token comment">//成员的操作，打印结果：mike, m, 18, 1, bj</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s, %c, %d, %d, %s\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s1<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">,</span> s1<span class="token punctuation">.</span>mystr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-2-5-2-结构体指针类型"><a href="#_8-2-5-2-结构体指针类型" class="header-anchor">#</a> 8.2.5.2 结构体指针类型</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//人</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//学生</span>
    <span class="token operator">*</span>Person <span class="token comment">// 匿名字段，结构体指针类型</span>
    id      <span class="token builtin">int</span>
    addr    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//初始化</span>
    s1 <span class="token operator">:=</span> Student<span class="token punctuation">{</span><span class="token operator">&amp;</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;bj&quot;</span><span class="token punctuation">}</span>

    <span class="token comment">//{Person:0xc0420023e0 id:1 addr:bj}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>
    <span class="token comment">//mike, m, 18</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s, %c, %d\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>age<span class="token punctuation">)</span>

    <span class="token comment">//声明变量</span>
    <span class="token keyword">var</span> s2 Student
    s2<span class="token punctuation">.</span>Person <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span> <span class="token comment">//分配空间</span>
    s2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    s2<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
    s2<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span>

    s2<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
    s2<span class="token punctuation">.</span>addr <span class="token operator">=</span> <span class="token string">&quot;sz&quot;</span>

    <span class="token comment">//yoyo 102 20 2 20</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s2<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s2<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s2<span class="token punctuation">.</span>id<span class="token punctuation">,</span> s2<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8-3-方法"><a href="#_8-3-方法" class="header-anchor">#</a> 8.3 方法</h2> <h3 id="_8-3-1-概述"><a href="#_8-3-1-概述" class="header-anchor">#</a> 8.3.1 概述</h3> <p>在面向对象编程中，一个对象其实也就是一个简单的值或者一个变量，在这个对象中会包含一些函数，这种带有接收者的函数，我们称为方法(method)。 本质上，一个方法则是一个和特殊类型关联的函数。</p> <p>一个面向对象的程序会用方法来表达其属性和对应的操作，这样使用这个对象的用户就不需要直接去操作对象，而是借助方法来做这些事情。</p> <p>在 Go 语言中，可以给任意自定义类型（包括内置类型，但不包括指针类型）添加相应的方法。</p> <p>⽅法总是绑定对象实例，并隐式将实例作为第⼀实参 (receiver)，方法的语法如下：
func (receiver ReceiverType) funcName(parameters) (results)
 参数 receiver 可任意命名。如⽅法中未曾使⽤，可省略参数名。
 参数 receiver 类型可以是 T 或 *T。基类型 T 不能是接⼝或指针。
 不支持重载方法，也就是说，不能定义名字相同但是不同参数的方法。</p> <h3 id="_8-3-2-为类型添加方法"><a href="#_8-3-2-为类型添加方法" class="header-anchor">#</a> 8.3.2 为类型添加方法</h3> <h4 id="_8-3-2-1-基础类型作为接收者"><a href="#_8-3-2-1-基础类型作为接收者" class="header-anchor">#</a> 8.3.2.1 基础类型作为接收者</h4> <p>type MyInt int //自定义类型，给 int 改名为 MyInt</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token comment">//在函数定义时，在其名字之前放上一个变量，即是一个方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a MyInt<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>b MyInt<span class="token punctuation">)</span> MyInt <span class="token punctuation">{</span> <span class="token comment">//面向对象</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token comment">//传统方式的定义</span>
<span class="token keyword">func</span> <span class="token function">Add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b MyInt<span class="token punctuation">)</span> MyInt <span class="token punctuation">{</span> <span class="token comment">//面向过程</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a MyInt <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">var</span> b MyInt <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token comment">//调用func (a MyInt) Add(b MyInt)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a.Add(b) = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//a.Add(b) =  2</span>

    <span class="token comment">//调用func Add(a, b MyInt)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Add(a, b) = &quot;</span><span class="token punctuation">,</span> <span class="token function">Add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//Add(a, b) =  2</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过上面的例子可以看出，面向对象只是换了一种语法形式来表达。方法是函数的语法糖，因为 receiver 其实就是方法所接收的第 1 个参数。</p> <p>注意：虽然方法的名字一模一样，但是如果接收者不一样，那么方法就不一样。</p> <h4 id="_8-3-2-2-结构体作为接收者"><a href="#_8-3-2-2-结构体作为接收者" class="header-anchor">#</a> 8.3.2.2 结构体作为接收者</h4> <p>方法里面可以访问接收者的字段，调用方法通过点( . )访问，就像 struct 里面访问字段一样：</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//给Person添加方法</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> p<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span> <span class="token comment">//初始化</span>
    p<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//调用func (p Person) PrintInfo()</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-3-值语义和引用语义"><a href="#_8-3-3-值语义和引用语义" class="header-anchor">#</a> 8.3.3 值语义和引用语义</h3> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//指针作为接收者，引用语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//给成员赋值</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token punctuation">}</span>

<span class="token comment">//值作为接收者，值语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//给成员赋值</span>
    p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//指针作为接收者，引用语义</span>
    p1 <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span> <span class="token comment">//初始化</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;函数调用前 = &quot;</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span>   <span class="token comment">//函数调用前 =  {mike 109 18}</span>
    <span class="token punctuation">(</span><span class="token operator">&amp;</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;函数调用后 = &quot;</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span> <span class="token comment">//函数调用后 =  {yoyo 102 22}</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;==========================&quot;</span><span class="token punctuation">)</span>

    p2 <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span> <span class="token comment">//初始化</span>
    <span class="token comment">//值作为接收者，值语义</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;函数调用前 = &quot;</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span> <span class="token comment">//函数调用前 =  {mike 109 18}</span>
    p2<span class="token punctuation">.</span><span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;函数调用后 = &quot;</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span> <span class="token comment">//函数调用后 =  {mike 109 18}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-4-方法集"><a href="#_8-3-4-方法集" class="header-anchor">#</a> 8.3.4 方法集</h3> <p>类型的方法集是指可以被该类型的值调用的所有方法的集合。</p> <p>用实例实例 value 和 pointer 调用方法（含匿名字段）不受⽅法集约束，编译器编总是查找全部方法，并自动转换 receiver 实参。</p> <h4 id="_8-3-4-1-类型-t-方法集"><a href="#_8-3-4-1-类型-t-方法集" class="header-anchor">#</a> 8.3.4.1 类型 *T 方法集</h4> <p>一个指向自定义类型的值的指针，它的方法集由该类型定义的所有方法组成，无论这些方法接受的是一个值还是一个指针。</p> <p>如果在指针上调用一个接受值的方法，Go 语言会聪明地将该指针解引用，并将指针所指的底层值作为方法的接收者。</p> <p>类型 *T ⽅法集包含全部 receiver T + *T ⽅法：</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//指针作为接收者，引用语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token punctuation">}</span>

<span class="token comment">//值作为接收者，值语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;xxx&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'m'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">33</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//p 为指针类型</span>
    <span class="token keyword">var</span> p <span class="token operator">*</span>Person <span class="token operator">=</span> <span class="token operator">&amp;</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    p<span class="token punctuation">.</span><span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//func (p) SetInfoPointer()</span>

    p<span class="token punctuation">.</span><span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//func (*p) SetInfoValue()</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//func (*p) SetInfoValue()</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-3-4-2-类型-t-方法集"><a href="#_8-3-4-2-类型-t-方法集" class="header-anchor">#</a> 8.3.4.2 类型 T 方法集</h4> <p>一个自定义类型值的方法集则由为该类型定义的接收者类型为值类型的方法组成，但是不包含那些接收者类型为指针的方法。</p> <p>但这种限制通常并不像这里所说的那样，因为如果我们只有一个值，仍然可以调用一个接收者为指针类型的方法，这可以借助于 Go 语言传值的地址能力实现。</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//指针作为接收者，引用语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yoyo&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token punctuation">}</span>

<span class="token comment">//值作为接收者，值语义</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;xxx&quot;</span>
    p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'m'</span>
    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">33</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//p 为普通值类型</span>
    <span class="token keyword">var</span> p Person <span class="token operator">=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    <span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//func (&amp;p) SetInfoPointer()</span>
    p<span class="token punctuation">.</span><span class="token function">SetInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//func (&amp;p) SetInfoPointer()</span>
    
    p<span class="token punctuation">.</span><span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">//func (p) SetInfoValue()</span>
    <span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//func (*&amp;p) SetInfoValue()</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-5-匿名字段"><a href="#_8-3-5-匿名字段" class="header-anchor">#</a> 8.3.5 匿名字段</h3> <h4 id="_8-3-5-1-方法的继承"><a href="#_8-3-5-1-方法的继承" class="header-anchor">#</a> 8.3.5.1 方法的继承</h4> <p>如果匿名字段实现了一个方法，那么包含这个匿名字段的 struct 也能调用该方法。</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//Person定义了方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s,%c,%d\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> p<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，那么Student包含了Person的所有字段</span>
    id     <span class="token builtin">int</span>
    addr   <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    p<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    s <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;yoyo&quot;</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;sz&quot;</span><span class="token punctuation">}</span>
    s<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-3-5-2-方法的重写"><a href="#_8-3-5-2-方法的重写" class="header-anchor">#</a> 8.3.5.2 方法的重写</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//Person定义了方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Person: %s,%c,%d\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> p<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Person <span class="token comment">// 匿名字段，那么Student包含了Person的所有字段</span>
    id     <span class="token builtin">int</span>
    addr   <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student定义了方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student：%s,%c,%d\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    p<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//Person: mike,m,18</span>

    s <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;yoyo&quot;</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;sz&quot;</span><span class="token punctuation">}</span>
    s<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">//Student：yoyo,f,20</span>
    s<span class="token punctuation">.</span>Person<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//Person: yoyo,f,20</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-6-表达式"><a href="#_8-3-6-表达式" class="header-anchor">#</a> 8.3.6 表达式</h3> <p>类似于我们可以对函数进行赋值和传递一样，方法也可以进行赋值和传递。</p> <p>根据调用者不同，方法分为两种表现形式：方法值和方法表达式。两者都可像普通函数那样赋值和传参，区别在于方法值绑定实例，⽽方法表达式则须显式传参。</p> <h4 id="_8-3-6-1-方法值"><a href="#_8-3-6-1-方法值" class="header-anchor">#</a> 8.3.6.1 方法值</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">PrintInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p, %v\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">PrintInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p, %v\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>p<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    p<span class="token punctuation">.</span><span class="token function">PrintInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//0xc0420023e0, &amp;{mike 109 18}</span>

    pFunc1 <span class="token operator">:=</span> p<span class="token punctuation">.</span>PrintInfoPointer <span class="token comment">//方法值，隐式传递 receiver</span>
    <span class="token function">pFunc1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment">//0xc0420023e0, &amp;{mike 109 18}</span>

    pFunc2 <span class="token operator">:=</span> p<span class="token punctuation">.</span>PrintInfoValue
    <span class="token function">pFunc2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//0xc042048420, {mike 109 18}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-3-6-2-方法表达式"><a href="#_8-3-6-2-方法表达式" class="header-anchor">#</a> 8.3.6.2 方法表达式</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    sex  <span class="token builtin">byte</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">PrintInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p, %v\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">PrintInfoValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p, %v\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>p<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    p <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
    p<span class="token punctuation">.</span><span class="token function">PrintInfoPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//0xc0420023e0, &amp;{mike 109 18}</span>

    <span class="token comment">//方法表达式， 须显式传参</span>
    <span class="token comment">//func pFunc1(p *Person))</span>
    pFunc1 <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>Person<span class="token punctuation">)</span><span class="token punctuation">.</span>PrintInfoPointer
    <span class="token function">pFunc1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token comment">//0xc0420023e0, &amp;{mike 109 18}</span>

    pFunc2 <span class="token operator">:=</span> Person<span class="token punctuation">.</span>PrintInfoValue
    <span class="token function">pFunc2</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token comment">//0xc042002460, {mike 109 18}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8-4-接口"><a href="#_8-4-接口" class="header-anchor">#</a> 8.4 接口</h2> <h3 id="_8-4-1-概述"><a href="#_8-4-1-概述" class="header-anchor">#</a> 8.4.1 概述</h3> <p>在 Go 语言中，接口(interface)是一个自定义类型，接口类型具体描述了一系列方法的集合。</p> <p>接口类型是一种抽象的类型，它不会暴露出它所代表的对象的内部值的结构和这个对象支持的基础操作的集合，它们只会展示出它们自己的方法。因此接口类型不能将其实例化。</p> <p>Go 通过接口实现了鸭子类型(duck-typing)：“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子”。我们并不关心对象是什么类型，到底是不是鸭子，只关心行为。</p> <h3 id="_8-4-2-接口的使用"><a href="#_8-4-2-接口的使用" class="header-anchor">#</a> 8.4.2 接口的使用</h3> <h4 id="_8-4-2-1-接口定义"><a href="#_8-4-2-1-接口定义" class="header-anchor">#</a> 8.4.2.1 接口定义</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Humaner <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p> 接⼝命名习惯以 er 结尾
 接口只有方法声明，没有实现，没有数据字段
 接口可以匿名嵌入其它接口，或嵌入到结构中</p> <h4 id="_8-4-2-2-接口实现"><a href="#_8-4-2-2-接口实现" class="header-anchor">#</a> 8.4.2.2 接口实现</h4> <p>接口是用来定义行为的类型。这些被定义的行为不由接口直接实现，而是通过方法由用户定义的类型实现，一个实现了这些方法的具体类型是这个接口类型的实例。</p> <p>如果用户定义的类型实现了某个接口类型声明的一组方法，那么这个用户定义的类型的值就可以赋给这个接口类型的值。这个赋值会把用户定义的类型的值存入接口类型的值。</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Humaner <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//学生</span>
    name  <span class="token builtin">string</span>
    score <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student实现SayHi()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student[%s, %f] say hi!!\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Teacher <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//老师</span>
    name  <span class="token builtin">string</span>
    group <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">//Teacher实现SayHi()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Teacher<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Teacher[%s, %s] say hi!!\n&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t<span class="token punctuation">.</span>group<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> MyStr <span class="token builtin">string</span>

<span class="token comment">//MyStr实现SayHi()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>str MyStr<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;MyStr[%s] say hi!!\n&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//普通函数，参数为Humaner类型的变量i</span>
<span class="token keyword">func</span> <span class="token function">WhoSayHi</span><span class="token punctuation">(</span>i Humaner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    i<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s <span class="token operator">:=</span> <span class="token operator">&amp;</span>Student<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">88.88</span><span class="token punctuation">}</span>
    t <span class="token operator">:=</span> <span class="token operator">&amp;</span>Teacher<span class="token punctuation">{</span><span class="token string">&quot;yoyo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">}</span>
    <span class="token keyword">var</span> tmp MyStr <span class="token operator">=</span> <span class="token string">&quot;测试&quot;</span>

    s<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//Student[mike, 88.880000] say hi!!</span>
    t<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//Teacher[yoyo, Go语言] say hi!!</span>
    tmp<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//MyStr[测试] say hi!!</span>

    <span class="token comment">//多态，调用同一接口，不同表现</span>
    <span class="token function">WhoSayHi</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>   <span class="token comment">//Student[mike, 88.880000] say hi!!</span>
    <span class="token function">WhoSayHi</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>   <span class="token comment">//Teacher[yoyo, Go语言] say hi!!</span>
    <span class="token function">WhoSayHi</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span> <span class="token comment">//MyStr[测试] say hi!!</span>

    x <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Humaner<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token comment">//这三个都是不同类型的元素，但是他们实现了interface同一个接口</span>
    x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> tmp
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> x <span class="token punctuation">{</span>
        value<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
        Student[mike, 88.880000] say hi!!
        Teacher[yoyo, Go语言] say hi!!
        MyStr[测试] say hi!!
    */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过上面的代码，你会发现接口就是一组抽象方法的集合，它必须由其他非接口类型实现，而不能自我实现。</p> <h3 id="_8-4-3-接口组合"><a href="#_8-4-3-接口组合" class="header-anchor">#</a> 8.4.3 接口组合</h3> <h4 id="_8-4-3-1-接口嵌入"><a href="#_8-4-3-1-接口嵌入" class="header-anchor">#</a> 8.4.3.1 接口嵌入</h4> <p>如果一个 interface1 作为 interface2 的一个嵌入字段，那么 interface2 隐式的包含了 interface1 里面的方法。</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Humaner <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Personer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    Humaner <span class="token comment">//这里想写了SayHi()一样</span>
    <span class="token function">Sing</span><span class="token punctuation">(</span>lyrics <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//学生</span>
    name  <span class="token builtin">string</span>
    score <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student实现SayHi()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student[%s, %f] say hi!!\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student实现Sing()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">Sing</span><span class="token punctuation">(</span>lyrics <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student sing[%s]!!\n&quot;</span><span class="token punctuation">,</span> lyrics<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s <span class="token operator">:=</span> <span class="token operator">&amp;</span>Student<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">88.88</span><span class="token punctuation">}</span>

    <span class="token keyword">var</span> i2 Personer
    i2 <span class="token operator">=</span> s
    i2<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//Student[mike, 88.880000] say hi!!</span>
    i2<span class="token punctuation">.</span><span class="token function">Sing</span><span class="token punctuation">(</span><span class="token string">&quot;学生哥&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Student sing[学生哥]!!</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-4-3-2-接口转换"><a href="#_8-4-3-2-接口转换" class="header-anchor">#</a> 8.4.3.2 接口转换</h4> <p>超集接⼝对象可转换为⼦集接⼝，反之出错：</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Humaner <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Personer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    Humaner <span class="token comment">//这里像写了SayHi()一样</span>
    <span class="token function">Sing</span><span class="token punctuation">(</span>lyrics <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token comment">//学生</span>
    name  <span class="token builtin">string</span>
    score <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student实现SayHi()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student[%s, %f] say hi!!\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//Student实现Sing()方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">Sing</span><span class="token punctuation">(</span>lyrics <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Student sing[%s]!!\n&quot;</span><span class="token punctuation">,</span> lyrics<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//var i1 Humaner = &amp;Student{&quot;mike&quot;, 88.88}</span>
    <span class="token comment">//var i2 Personer = i1 //err</span>

    <span class="token comment">//Personer为超集，Humaner为子集</span>
    <span class="token keyword">var</span> i1 Personer <span class="token operator">=</span> <span class="token operator">&amp;</span>Student<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">88.88</span><span class="token punctuation">}</span>
    <span class="token keyword">var</span> i2 Humaner <span class="token operator">=</span> i1
    i2<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//Student[mike, 88.880000] say hi!!</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-4-4-空接口"><a href="#_8-4-4-空接口" class="header-anchor">#</a> 8.4.4 空接口</h3> <p>空接口(interface{})不包含任何的方法，正因为如此，所有的类型都实现了空接口，因此空接口可以存储任意类型的数值。它有点类似于 C 语言的 void *类型。</p> <div class="language-Go extra-class"><pre class="language-go"><code>    <span class="token keyword">var</span> v1 <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token number">1</span>     <span class="token comment">// 将int类型赋值给interface{}</span>
    <span class="token keyword">var</span> v2 <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span> <span class="token comment">// 将string类型赋值给interface{}</span>
    <span class="token keyword">var</span> v3 <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>v2   <span class="token comment">// 将*interface{}类型赋值给interface{}</span>
    <span class="token keyword">var</span> v4 <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span> X <span class="token builtin">int</span> <span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
    <span class="token keyword">var</span> v5 <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">struct</span><span class="token punctuation">{</span> X <span class="token builtin">int</span> <span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
</code></pre></div><p>当函数可以接受任意的对象实例时，我们会将其声明为 interface{}，最典型的例子是标准库 fmt 中 PrintXXX 系列的函数，例如：</p> <div class="language-Go extra-class"><pre class="language-go"><code>    <span class="token keyword">func</span> <span class="token function">Printf</span><span class="token punctuation">(</span>fmt <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">Println</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_8-4-5-类型查询"><a href="#_8-4-5-类型查询" class="header-anchor">#</a> 8.4.5 类型查询</h3> <p>我们知道 interface 的变量里面可以存储任意类型的数值(该类型实现了 interface)。那么我们怎么反向知道这个变量里面实际保存了的是哪个类型的对象呢？目前常用的有两种方法：
comma-ok 断言
switch 测试</p> <h4 id="_8-4-5-1-comma-ok-断言"><a href="#_8-4-5-1-comma-ok-断言" class="header-anchor">#</a> 8.4.5.1 comma-ok 断言</h4> <p>Go 语言里面有一个语法，可以直接判断是否是该类型的变量： value, ok = element.(T)，这里 value 就是变量的值，ok 是一个 bool 类型，element 是 interface 变量，T 是断言的类型。</p> <p>如果 element 里面确实存储了 T 类型的数值，那么 ok 返回 true，否则返回 false。</p> <p>示例代码：</p> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Element <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Element<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>       <span class="token comment">// an int</span>
    list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span> <span class="token comment">// a string</span>
    list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>

    <span class="token keyword">for</span> index<span class="token punctuation">,</span> element <span class="token operator">:=</span> <span class="token keyword">range</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> element<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is an int and its value is %d\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> element<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is a string and its value is %s\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> element<span class="token punctuation">.</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is a Person and its value is [%s, %d]\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is of a different type\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*  打印结果：
    list[0] is an int and its value is 1
    list[1] is a string and its value is Hello
    list[2] is a Person and its value is [mike, 18]
    */</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-4-5-2-switch-测试"><a href="#_8-4-5-2-switch-测试" class="header-anchor">#</a> 8.4.5.2 switch 测试</h4> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Element <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Element<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>       <span class="token comment">//an int</span>
    list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span> <span class="token comment">//a string</span>
    list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>

    <span class="token keyword">for</span> index<span class="token punctuation">,</span> element <span class="token operator">:=</span> <span class="token keyword">range</span> list <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> value <span class="token operator">:=</span> element<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is an int and its value is %d\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token builtin">string</span><span class="token punctuation">:</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is a string and its value is %s\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token keyword">case</span> Person<span class="token punctuation">:</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is a Person and its value is [%s, %d]\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;list[%d] is of a different type&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.10b0d601.js" defer></script><script src="/assets/js/2.2959cc1c.js" defer></script><script src="/assets/js/17.579cf571.js" defer></script>
  </body>
</html>
